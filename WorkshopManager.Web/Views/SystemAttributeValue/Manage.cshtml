@model SystemAttributeValueViewModel

@{
    ViewData["Title"] = "Manage";
}

<div class="p-4">
    <div class="row">
        <div class="col-4">
            <div class="card h-100">
                <div class="card-header bg-secondary"><strong>Manage System Attribute Values</strong></div>
                <div class="card-body">
                    <form method="post" asp-action="Manage" asp-controller="SystemAttributeValue">
                        <input asp-for="@Model.SystemAttributeValue.Id" hidden/>
                        <div class="mb-3">
                            <label asp-for="@Model.SystemAttributeValue.AttributeValue" class="form-label"></label>
                            <input asp-for="@Model.SystemAttributeValue.AttributeValue" class="form-control" id="txtAttributeValue" onchange="validateForm()"/>
                        </div>
                        <div class="mb-3">
                            <label asp-for="@Model.SystemAttributeValue.SystemAttribute.AttributeName" class="form-label"></label>
                            <select asp-for="@Model.SystemAttributeValue.SystemAttributeId" asp-items="ViewBag.SystemAttributes" class="form-select" id="selectAttributeValue" onchange="validateForm()">
                                <option disabled selected>--Select System Attribute--</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <button class="form-submit" type="submit" id="btnSubmit">Submit Changes</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-8">
            <div class="card h-100">
            <div class="card-header bg-secondary"><strong>System Attribute Values</strong></div>
            <div class="card-body">
                <table id=tblAttributeValues>
                    <thead>
                        <tr>
                            <th>Id</th>
                            <th>Attribute Type</th>
                            <th>Attribute Value</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach(var attributeVal in @Model.SystemAttributeValues)
                        {
                            <tr>
                                <td>@attributeVal.Id.ToString().ToUpper()</td>
                                <td>@attributeVal.SystemAttribute.AttributeName</td>
                                <td>@attributeVal.AttributeValue</td>
                                <td> 
                                    <a class="table-edit" asp-action="Manage" asp-controller="SystemAttributeValue" asp-route-id="@attributeVal.Id">
                                        <i class="bi bi-pencil"></i> Edit
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $('#btnSubmit').attr('disabled', true);
        validateForm()
        loadDataTableWithSearchAndPagination('#tblAttributeValues');
    });

    function validateForm(){
        var attributeNameVal = validateString($('#txtAttributeValue').val());
        var attributeTypeVal = validateGUID($('#selectAttributeValue').val());
        console.log(attributeNameVal);
        if(attributeNameVal == "1" && attributeTypeVal == "1"){
            $('#btnSubmit').attr('disabled', false);
        } else{
            $('#btnSubmit').attr('disabled', true);
        }
    }

</script>